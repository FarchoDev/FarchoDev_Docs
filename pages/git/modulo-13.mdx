# Módulo 13: Mantenimiento y Optimización de Repositorios Git

En este módulo, aprenderás cómo mantener y optimizar tus repositorios Git para asegurar que se mantengan eficientes y fáciles de manejar a medida que crecen. Exploraremos técnicas y comandos avanzados que te ayudarán a mantener tu repositorio en buen estado.

## 13.1. Limpieza y Mantenimiento del Repositorio

### Eliminación de Branches Obsoletas

Con el tiempo, es posible que acumules muchas branches que ya no son necesarias. Mantener el repositorio limpio eliminando branches obsoletas es una buena práctica.

- **Listar Branches Locales y Remotas**:

  ```bash
  git branch -a
  ```

- **Eliminar una Branch Local**:

  ```bash
  git branch -d nombre-de-branch
  ```

- **Eliminar una Branch Remota**:

  ```bash
  git push origin --delete nombre-de-branch
  ```

### Limpieza de Objetos Huérfanos

Los objetos huérfanos son commits, blobs y árboles que ya no son referenciados por ninguna branch o etiqueta. Git los mantiene en el repositorio, pero pueden ocupar espacio innecesario.

- **Eliminar Objetos Huérfanos**:

  ```bash
  git gc --prune=now
  ```

### Optimización del Tamaño del Repositorio

Con el tiempo, el tamaño de tu repositorio puede crecer debido a grandes archivos o muchos commits. Git ofrece comandos para optimizar el almacenamiento.

- **Ver el Tamaño del Repositorio**:

  ```bash
  git count-objects -vH
  ```

- **Reducir el Tamaño del Repositorio**:

  ```bash
  git gc --aggressive
  ```

## 13.2. Auditoría y Seguimiento

### Uso de Git Bisect para Encontrar Errores

`git bisect` es una herramienta útil para encontrar commits que introducen errores en el código. Funciona realizando una búsqueda binaria entre un estado "bueno" y un estado "malo".

- **Iniciar una Búsqueda Binaria**:

  ```bash
  git bisect start
  git bisect bad # marca el estado actual como malo
  git bisect good <commit_id> # marca un commit anterior como bueno
  ```

- **Marcar Commits Durante la Búsqueda**:

  ```bash
  git bisect good/bad
  ```

- **Terminar la Búsqueda Binaria**:

  ```bash
  git bisect reset
  ```

### Registro de Actividades con Git Log

`git log` es una herramienta poderosa para revisar el historial de commits y actividades en el repositorio.

- **Ver el Historial Completo**:

  ```bash
  git log
  ```

- **Ver el Historial de un Archivo Específico**:

  ```bash
  git log -- path/al/archivo
  ```

- **Formato Personalizado del Historial**:

  ```bash
  git log --pretty=format:"%h - %an, %ar : %s"
  ```

## 13.3. Estrategias de Backup y Recuperación

### Backup de un Repositorio

Realizar backups regulares de tus repositorios asegura que no perderás tu trabajo en caso de fallo del sistema o errores humanos.

- **Clonar un Repositorio como Backup**:

  ```bash
  git clone --mirror https://github.com/usuario/repositorio.git
  ```

### Recuperación de Datos

En caso de que se pierdan datos, Git ofrece varias maneras de recuperar commits y branches eliminados.

- **Recuperar una Branch Eliminada**:

  ```bash
  git reflog
  git checkout -b nombre-de-branch <commit_id>
  ```

- **Recuperar Commits Eliminados**:

  ```bash
  git fsck --full
  ```

## Resumen

En este módulo, hemos cubierto técnicas avanzadas para mantener y optimizar repositorios Git:

- **Limpieza y Mantenimiento del Repositorio**: Eliminación de branches obsoletas, limpieza de objetos huérfanos y optimización del tamaño del repositorio.
- **Auditoría y Seguimiento**: Uso de `git bisect` para encontrar errores y `git log` para revisar el historial de actividades.
- **Estrategias de Backup y Recuperación**: Realización de backups regulares y recuperación de datos en caso de pérdida.

Estas prácticas te ayudarán a mantener tus repositorios Git en buen estado, asegurando que sigan siendo eficientes y manejables a medida que crecen.